"use strict";(self.webpackChunkeverscale_docs_website=self.webpackChunkeverscale_docs_website||[]).push([[4138],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=d(n),h=r,m=p["".concat(l,".").concat(h)]||p[h]||u[h]||o;return n?a.createElement(m,i(i({ref:t},c),{},{components:n})):a.createElement(m,i({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:r,i[1]=s;for(var d=2;d<o;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},5962:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>d});var a=n(7462),r=(n(7294),n(3905));const o={sidebar_position:3},i="DHT - Distributed Hash Table",s={unversionedId:"arch/networking/dht",id:"arch/networking/dht",title:"DHT - Distributed Hash Table",description:"In fact, it is a distributed key-value database, where each network participant can save something. In Everscale, it is used to locate nodes in the network.",source:"@site/../../src/arch/networking/dht.md",sourceDirName:"arch/networking",slug:"/arch/networking/dht",permalink:"/arch/networking/dht",draft:!1,editUrl:"https://github.com/everscale-org/docs/edit/main/.build/website/../../src/arch/networking/dht.md",tags:[],version:"current",lastUpdatedAt:1693250325,formattedLastUpdatedAt:"Aug 28, 2023",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"ADNL",permalink:"/arch/networking/adnl"},next:{title:"RLDP",permalink:"/arch/networking/rldp"}},l={},d=[{value:"DHT nodes",id:"dht-nodes",level:2},{value:"Kademlia routing table",id:"kademlia-routing-table",level:2},{value:"Key-value pairs",id:"key-value-pairs",level:2}],c={toc:d},p="wrapper";function u(e){let{components:t,...n}=e;return(0,r.kt)(p,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"dht---distributed-hash-table"},"DHT - Distributed Hash Table"),(0,r.kt)("p",null,"In fact, it is a distributed key-value database, where each network participant can save something. In Everscale, it is used to locate nodes in the network. "),(0,r.kt)("p",null,"The implementation of DHT in Everscale is similar to that of Kademlia used in IPFS. Any member of the network can run a DHT node, to generate keys and store data. To do this, it is needed to generate a random ID and inform other nodes about it."),(0,r.kt)("p",null,"To determine in which node to save data, a special algorithm to determine the distance (it is not about geographic location) between the node and the key is used. The algorithm is pretty straightforward: it is just needed to take both the ID of the node and the ID of the key, and perform the XOR operation. The smaller the resulting value, the closer the node is. The task is to keep the key as close to the nodes as possible. This way, other network participants can use the algorithm to find a node that can provide data about the key."),(0,r.kt)("h2",{id:"dht-nodes"},"DHT nodes"),(0,r.kt)("p",null,"Each DHT node has a 256-bit DHT address. Contrary to ADNL addresses, a DHT address should not change often. In case it is changed too often, other nodes would not be able to locate the keys they are searching for. "),(0,r.kt)("p",null,"It is expected that the value of key ",(0,r.kt)("inlineCode",{parentName:"p"},"K")," will be stored on ",(0,r.kt)("inlineCode",{parentName:"p"},"S")," Kademlia-nearest nodes to ",(0,r.kt)("inlineCode",{parentName:"p"},"K"),"."),(0,r.kt)("p",null,"Kademlia distance = 256-bit key ",(0,r.kt)("inlineCode",{parentName:"p"},"XOR")," 256-bit DHT node address. "),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"S")," is a small parameter, for example ",(0,r.kt)("inlineCode",{parentName:"p"},"S = 7"),", which is required in order to improve the reliability of DHT. If we were to keep the key only on one node. The nearest one to ",(0,r.kt)("inlineCode",{parentName:"p"},"K"),". The value of the respective key would be lost if that single node goes offline."),(0,r.kt)("h2",{id:"kademlia-routing-table"},"Kademlia routing table"),(0,r.kt)("p",null,"Each node in DHT usually keeps a Kademlia routing table. It is comprised of 256 buckets (from 0 to 255). "),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"i"),"-th bucket incorporates the information about some known nodes, a fixed number of the \u201cbest\u201d nodes and maybe some extra candidates that find themselves at a Kademlia distance from ",(0,r.kt)("inlineCode",{parentName:"p"},"2^i")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"2^(i+1) \u2212 1")," from the node\u2019s address ",(0,r.kt)("inlineCode",{parentName:"p"},"a"),"."),(0,r.kt)("p",null,"The information includes: ",(0,r.kt)("strong",{parentName:"p"},"DHT addresses, IP addresses and UDP ports"),". Also, there is some other information such as the ",(0,r.kt)("strong",{parentName:"p"},"time")," and the ",(0,r.kt)("strong",{parentName:"p"},"delay")," of the last ping."),(0,r.kt)("p",null,"When a Kademlia node learns about any other Kademlia node as a result of some query, it places it into a suitable bucket of its routing table. First, as a candidate, then, if some of the \u201cbest\u201d nodes in that bucket fail, for instance, do not respond to ping queries for a long time, they can be replaced by some of these candidates. In this way, the Kademlia routing table stays populated."),(0,r.kt)("h2",{id:"key-value-pairs"},"Key-value pairs"),(0,r.kt)("p",null,"Everscale DHT allows key-value pairs addition and editing."),(0,r.kt)("p",null,"It should be mentioned that ",(0,r.kt)("strong",{parentName:"p"},"updating rules")," can vary. In some instances, it is just the replacement of the old value with the new one. It is applicable in case the new value is signed by the owner. The signature, in turn, must be kept as part of the value. It is to be checked later by other nodes after they obtain the value of the key. In other instances, the old value somehow affects the new value. For instance, it can contain a sequence number and the old value is overwritten only if the new sequence number is larger. This is done in order to prevent replay attacks."),(0,r.kt)("p",null,"The purpose of Everscale DHT is not only for storing IP Addresses of ADNL nodes. Besides this, it has many other applications, such as, the storage of: "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Lists of addresses of nodes included in an overlay subnetwork"),(0,r.kt)("li",{parentName:"ul"},"ADNL Addresses of Everscale services "),(0,r.kt)("li",{parentName:"ul"},"ADNL addresses of accounts of the Everscale blockchain")))}u.isMDXComponent=!0}}]);