"use strict";(self.webpackChunkeverscale_docs_website=self.webpackChunkeverscale_docs_website||[]).push([[5250],{3905:(e,t,a)=>{a.d(t,{Zo:()=>l,kt:()=>m});var n=a(7294);function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){s(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,s=function(e,t){if(null==e)return{};var a,n,s={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(s[a]=e[a]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}var c=n.createContext({}),u=function(e){var t=n.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},l=function(e){var t=u(e.components);return n.createElement(c.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,s=e.mdxType,r=e.originalType,c=e.parentName,l=o(e,["components","mdxType","originalType","parentName"]),p=u(a),h=s,m=p["".concat(c,".").concat(h)]||p[h]||d[h]||r;return a?n.createElement(m,i(i({ref:t},l),{},{components:a})):n.createElement(m,i({ref:t},l))}));function m(e,t){var a=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var r=a.length,i=new Array(r);i[0]=h;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o[p]="string"==typeof e?e:s,i[1]=o;for(var u=2;u<r;u++)i[u]=a[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},510:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>o,toc:()=>u});var n=a(7462),s=(a(7294),a(3905));const r={},i="Transactions",o={unversionedId:"arch/transactions",id:"arch/transactions",title:"Transactions",description:"Let\u2019s once again recall that all interactions on Evercale network are performed via messages. Messages, in turn, create transactions that modify the account's state.",source:"@site/../../src/arch/50-transactions.md",sourceDirName:"arch",slug:"/arch/transactions",permalink:"/arch/transactions",draft:!1,editUrl:"https://github.com/everscale-org/docs/edit/main/.build/website/../../src/arch/50-transactions.md",tags:[],version:"current",lastUpdatedAt:1693835149,formattedLastUpdatedAt:"Sep 4, 2023",sidebarPosition:50,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Message",permalink:"/arch/message"},next:{title:"Security",permalink:"/arch/security"}},c={},u=[{value:"Transaction",id:"transaction",level:2},{value:"Transaction phases",id:"transaction-phases",level:2},{value:"Specification",id:"specification",level:2},{value:"How to determine a successful transaction?",id:"how-to-determine-a-successful-transaction",level:2}],l={toc:u},p="wrapper";function d(e){let{components:t,...r}=e;return(0,s.kt)(p,(0,n.Z)({},l,r,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"transactions"},"Transactions"),(0,s.kt)("p",null,"Let\u2019s once again recall that all interactions on Evercale network are performed via messages. Messages, in turn, create transactions that modify the account's state. "),(0,s.kt)("p",null,(0,s.kt)("img",{src:a(1147).Z,width:"1607",height:"1924"})),(0,s.kt)("h2",{id:"transaction"},"Transaction"),(0,s.kt)("p",null,"A transaction is the result of an inbound message processing by a recipient account code. That is, when an account receives an inbound message, it leads to the computation of the account's new state and the possibility of generating one or more outbound messages with the account serving as the source. The inbound message and the previous state of the account serve as inputs for the transaction, while the generated outbound messages and the next state of the account serve as outputs. This relationship can be represented as a Directed Acyclic Graph (DAG)."),(0,s.kt)("p",null,(0,s.kt)("img",{src:a(7058).Z,width:"1607",height:"1080"})),(0,s.kt)("h2",{id:"transaction-phases"},"Transaction phases"),(0,s.kt)("p",null,"A transaction is composed of several phases. Each phase may either complete successfully or result in an error. In case of error, the next stage is not completed."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Storage phase")," - is for the collection of storage payments for the account state (smart contract code and data). Throughout this phase, the smart contract may be frozen if its balance is insufficient to pay the storage fee. It is worth mentioning that there is no storage phase if the transaction is sent to deploy a new smart contract."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Credit phase")," - adding the value of the internal message received to the account's balance."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Computing phase")," - starts when the smart contract code is invoked inside an instance of TVM with appropriate parameters, including the inbound message and the account's persistent data. The result of this phase is an exit code, new persistent data, and an action list, which includes outbound messages to be sent. Also, it may end up creating a new account, uninitialized or active, or activating a previously uninitialized or frozen account. The gas fee for computation is deducted from the account balance."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Action phase")," - starts when the actions from the actions list are performed if the smart contract is executed successfully (with exit code 0 or 1). Suppose, it is impossible to perform all the actions. For example, because of insufficient funds to transfer with an outbound message. In that case, the transaction is terminated, and the account state is rolled back."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Bounce phase")," - starts when a transaction is terminated. That is, the inbound message has its bounce flag set. Respectively, there is an automatically generated outbound message, with the bounce flag clear, transferring the funds back to the sender. It takes the value of the original inbound message, deducts gas and forwarding fees and transfers the resulting amount to the newly generated message. "),(0,s.kt)("h2",{id:"specification"},"Specification"),(0,s.kt)("p",null,"Read more about transactions execution in ",(0,s.kt)("a",{parentName:"p",href:"/arch/executor#transaction"},"Transaction executor Specification")),(0,s.kt)("h2",{id:"how-to-determine-a-successful-transaction"},"How to determine a successful transaction?"),(0,s.kt)("p",null,"It depends on the account state before and after the transaction (fields\xa0",(0,s.kt)("inlineCode",{parentName:"p"},"orig_status"),"\xa0and\xa0",(0,s.kt)("inlineCode",{parentName:"p"},"end_status"),"):"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"If the account was already deployed, i.e. if ",(0,s.kt)("inlineCode",{parentName:"p"},"(tx.orig_status == tx.end_status == active)"),"\xa0then you can use\xa0",(0,s.kt)("inlineCode",{parentName:"p"},"tx.aborted")," field. If it is\xa0",(0,s.kt)("inlineCode",{parentName:"p"},"true"),", then the transaction is not successful.")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"If the account was not yet deployed then"),(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"if\xa0",(0,s.kt)("inlineCode",{parentName:"p"},"(orig_status == nonExist && end_status == uninit && aborted == true)"),"\xa0then transaction is successful."),(0,s.kt)("p",{parentName:"li"},"   All the transactions executed on non-deployed accounts are aborted by definition but if we see the state has changed to\xa0",(0,s.kt)("inlineCode",{parentName:"p"},"uninit"),", it means that the transfer was successfully received.")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"if\xa0",(0,s.kt)("inlineCode",{parentName:"p"},"(orig_status == uninit && end_status == uninit && aborted == true && in_message.bounce==false)"),"then transaction is successful."),(0,s.kt)("p",{parentName:"li"},"   Non-bounced messages are successfully received by non-deployed accounts, though the transaction status is aborted."),(0,s.kt)("p",{parentName:"li"},"   Instead of checking\xa0",(0,s.kt)("inlineCode",{parentName:"p"},"tx.in_message.bounce==false"),"\xa0you can check if ",(0,s.kt)("inlineCode",{parentName:"p"},"tx.bounce.bounce_type<2"),"\xa0(tx.bounce.bounce_type==2(Ok) is equal to in_message.bounce==true)"))))))}d.isMDXComponent=!0},1147:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/tp-1-b698dc5ed41904b2a3bdc8aecdcfbf2c.svg"},7058:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/tp-2-b9c92898c6cd979a87ce93d59c14285c.svg"}}]);