<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-arch/fee-calculation">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Fee calculation | Docs of Everscale</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.everscale.network/arch/fee-calculation/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Fee calculation | Docs of Everscale"><meta data-rh="true" name="description" content="Explanation of the formulas for fee calculation"><meta data-rh="true" property="og:description" content="Explanation of the formulas for fee calculation"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.everscale.network/arch/fee-calculation/"><link data-rh="true" rel="alternate" href="https://docs.everscale.network/arch/fee-calculation" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.everscale.network/arch/fee-calculation" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JMT2J0B3ZE"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-JMT2J0B3ZE",{anonymize_ip:!0})</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.440da354.css">
<link rel="preload" href="/assets/js/runtime~main.2cff1c02.js" as="script">
<link rel="preload" href="/assets/js/main.d6bf648e.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Everscale Docs" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Everscale Docs" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Everscale Docs</b></a><a class="navbar__item navbar__link" href="/overview/">Overview</a><a class="navbar__item navbar__link" href="/develop/">Build</a><a class="navbar__item navbar__link" href="/validate/">Validate</a><a class="navbar__item navbar__link" href="/standard/">Standards</a><a href="https://everscale.guide/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Crash Course<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/contribute/">Contribute</a><a href="https://blog.everscale.network/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://monitoring.ever.rs/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Status<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/everscale-org/docs/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Welcome to Everscale</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/overview">Overview</a><button aria-label="Toggle the collapsible sidebar category &#x27;Overview&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/develop">Build</a><button aria-label="Toggle the collapsible sidebar category &#x27;Build&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/validate">Run Validator</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/spec">Specifications</a><button aria-label="Toggle the collapsible sidebar category &#x27;Specifications&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/standard">Standards</a><button aria-label="Toggle the collapsible sidebar category &#x27;Standards&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/arch">Architecture</a><button aria-label="Toggle the collapsible sidebar category &#x27;Architecture&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/arch/basics">Basics</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/arch/networking">Networking</a><button aria-label="Toggle the collapsible sidebar category &#x27;Networking&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/arch/consensus">Consensus</a><button aria-label="Toggle the collapsible sidebar category &#x27;Consensus&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/arch/tlb-and-boc">TL-B and BoC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/arch/tvm">TVM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/arch/fee-calculation">Fee calculation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/arch/managing-gas">Gas Calculation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/arch/executor">Transaction executor</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/arch/logic-time">Logical Time</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/arch/accounts">Accounts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/arch/message">Message</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/arch/transactions">Transactions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/arch/security">Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/arch/workchains">Workchains</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/arch/multithreading">Multithreading</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/contribute">Contribute</a><button aria-label="Toggle the collapsible sidebar category &#x27;Contribute&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/arch"><span itemprop="name">Architecture</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Fee calculation</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Network Fees</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="fee-calculation">Fee calculation<a href="#fee-calculation" class="hash-link" aria-label="Direct link to Fee calculation" title="Direct link to Fee calculation">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h3><p>Transaction fees consist of a few types of different fees connected to the execution of a single transaction. Transactions itself are complex processes, and fees are paid relative to different stages of executing them.</p><p>In this document, we explain how the fees are calculated.</p><p>We shall define transaction_fee as a sum of all fees for a single transaction.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">transaction_fee = inbound_external_message_fee</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                + storage_fees</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                + gas_fees</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                + total_action_fees</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                + outbound_internal_messages_fee</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Where:</p><p><code>inbound_external_message_fee</code> — is deducted, if an <a href="#inbound-external-messages">inbound external message</a> is imported in the transaction.</p><p><code>storage_fees</code> — <a href="#storage-fees">storage costs</a> since the moment of the last transaction.</p><p><code>gas_fees</code> — include all gas fees associated with the transaction. You can find more info in the <a href="/arch/managing-gas#gas-calculation-basics">Gas calculation basics</a> section.</p><p><code>total_action_fees</code> — fees for performing <em>send message</em> <a href="#action-fees">actions</a>.</p><p><code>outbound_internal_messages_fee</code> — is calculated as a sum of fees for all <a href="#outbound-messages">outbound internal messages</a> generated by the transaction.</p><p>Depending on the nature of the transaction, all of these except storage fees may not be applicable.</p><p>Below we examine these types of fees in detail.</p><blockquote><p><strong>Note:</strong> Block creation fee is not to be confused with the fees discussed in this document. Block creation fee is the new coins minted by the elector contract and distributed among validators as reward for creating blocks. It is not part of transaction fees.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage-fees">Storage fees<a href="#storage-fees" class="hash-link" aria-label="Direct link to Storage fees" title="Direct link to Storage fees">​</a></h3><p>Every transaction in Everscale has a storage phase that implies a certain storage fee charged on an account balance. This fee is charged for the period between transactions and is calculated according to the following formula:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">storage_fees = CEIL(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        account.bits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        * global_bit_price</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        + account.cells</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        * global_cell_price</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) * period / 2 ^ 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Where:</p><p><code>account.bits</code> and <code>account.cells</code> — stand for a number of bits and cells in the Account structure represented as tree of cells (including code and data).</p><p><code>global_bit_price</code> — is a global configuration parameter (<code>p18</code> for both masterchain and workchains), price for storing one bit.</p><p><code>global_cell_price</code> — another global configuration parameter (<code>p18</code> for both masterchain and workchains), price for storing one cell.</p><p><code>period</code> — number of seconds since previous storage fee payment.</p><blockquote><p><strong>Note:</strong> While <code>account.bits</code> are generally easy to estimate, the <code>account.cells</code> value can vary greatly for different types of data. A cell can contain no more than 1023 bits and 4 references to other cells. Contract code and numerical variables tend to be packed into cells effectively, resulting in mostly full cells, and thus a minimal number of cells needed to store the data. More complex data structures can be packed into cells less efficiently, taking up more cells to store the same amount of data.</p></blockquote><p><strong>Example:</strong> Let&#x27;s calculate a minimal fee for storing 1KB of data for the duration of one day on a workchain:</p><p><code>global_bit_price</code> = 1</p><p><code>global_cell_price</code> = 500</p><p><code>period</code> = 86400 seconds</p><p><code>account.bits</code> = 8192</p><p>The minimal <code>account.cells</code> value for 8192 bits of data is 9 (rounding 8192/1023 up to the nearest integer).</p><p>Thus the minimum storage fee would be calculated as follows:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">storage_fees = CEIL(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        8192</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        * 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        + 9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        * 500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ) * 86400 / 65536</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) = 16733 nanotokens = 0.000016733 tokens</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Real storage fees for 1KB account can be higher, depending on the specific features of the contract.</p><p>If the account balance is less than the due storage fee, the account is frozen and its balance is subtracted from storage fee and reduced to zero. Remaining storage fee is stored in account as debt.</p><blockquote><p><strong>Note:</strong> Current global configuration can be always reviewed on <!-- -->[ever.live]<!-- -->( https:/ /ever.live/) in the master config section of the latest key block details (<a href="https://net.ever.live/blocks?section=details&amp;id=8cee868a94b1e22794a927279286dc95498310cda982f4657e351a3da693cf27" target="_blank" rel="noopener noreferrer">example</a>) <code>FIXME broken link</code>. It can only be changed by a vote of validators.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="message-fees">Message fees<a href="#message-fees" class="hash-link" aria-label="Direct link to Message fees" title="Direct link to Message fees">​</a></h3><p>Every message is subject to a forwarding fee, which is calculated according to the following formula:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msg_fwd_fee = (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lump_price + CEIL(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            bit_price</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            * msg.bits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            + cell_price</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            * msg.cells</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ) / 2 ^ 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>msg.bits</code> and <code>msg.cells</code> are calculated from message represented as a tree of cells. Root cell is not counted. <code>lump_price</code>, <code>bit_price</code>, <code>cell_price</code> are contained in global config parameters <code>p24</code> and <code>p25</code>, and can and can only be changed by a vote of validators.</p><blockquote><p><strong>Note:</strong> Like in storage fees, <code>msg.bits</code> are generally easy to estimate, while the <code>msg.cells</code> value can vary for different types of messages.</p></blockquote><p><strong>Example:</strong> Let&#x27;s calculate a minimal forward fee for sending a 1KB message on a workchain:</p><p><code>lump_price</code> = 10000000</p><p><code>bit_price</code> = 655360000</p><p><code>cell_price</code> = 65536000000</p><p>To calculate <code>msg.bits</code> we subtract the root cell bits from the total message bits. For this example we&#x27;ll assume that the root cell is filled completely (usually this is not the case, and the subtracted value is smaller, which results in a higher fee):</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msg.bits = 8192 - 1023 = 7169</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To calculate <code>msg.cells</code> we subtract the root cell from the total umber of cells. The minimal number of cells in a 1 KB message is 9 (rounding 8192/1023 up to the nearest integer). Thus <code>msg.cells</code> is calculated as follows:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msg.bits = 9 - 1 = 8</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The minimum forward fee for a 1KB message would be calculated as follows:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msg_fwd_fee = (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    10000000 + CEIL(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            655360000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            * 7169</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            + 65536000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            * 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ) / 65536</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) = 89690000 nanotokens = 0.08969 tokens</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Real forward fees for 1 KB messages may be higher, depending on the type and contents of the message.</p><blockquote><p><strong>Note:</strong> Current global configuration can be always reviewed on <a href="https://ever.live/" target="_blank" rel="noopener noreferrer">ever.live</a> in the master config section of the latest key block details (<a href="https://net.ton.live/blocks?section=details&amp;id=8cee868a94b1e22794a927279286dc95498310cda982f4657e351a3da693cf27" target="_blank" rel="noopener noreferrer">example</a>) <code>FIXME broken link</code>.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="outbound-messages">Outbound messages<a href="#outbound-messages" class="hash-link" aria-label="Direct link to Outbound messages" title="Direct link to Outbound messages">​</a></h4><p><code>outbound_internal_messages_fee</code> is calculated <strong>as a sum</strong> of outbound internal message fees for every message generated as result of transaction execution:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">outbound_internal_messages_fee = SUM(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    out_int_msg.header.fwd_fee</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    + out_int_msg.header.ihr_fee</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Where</p><p><code>out_int_msg.header.fwd_fee</code> is a part of the standard forward fee for the outbound internal message.</p><p><code>out_int_msg.header.ihr_fee</code> is currently disabled.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="routing">Routing<a href="#routing" class="hash-link" aria-label="Direct link to Routing" title="Direct link to Routing">​</a></h5><p>The forward fee for outbound internal message is split into <code>int_msg_mine_fee</code> and <code>int_msg_remain_fee</code>:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msg_forward_fee = int_msg_mine_fee + int_msg_remain_fee</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Where:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">int_msg_mine_fee = msg_forward_fee * first_frac / 2 ^ 16</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>first_frac</code> — is contained in global config parameters <code>p24</code> and <code>p25</code>, and determines the fraction of the fee, that the current set of validators receive.</p><blockquote><p><strong>Note:</strong> Current global configuration can be always reviewed on <a href="https://ever.live/" target="_blank" rel="noopener noreferrer">ever.live</a> in the master config section of the latest key block details (<a href="https://net.ton.ever/blocks?section=details&amp;id=8cee868a94b1e22794a927279286dc95498310cda982f4657e351a3da693cf27" target="_blank" rel="noopener noreferrer">example</a>) <code>FIXME broken link</code>.</p></blockquote><p><code>int_msg_mine_fee</code> then becomes part of transaction action fees (see below).</p><p>The remaining <code>int_msg_remain_fee</code> is placed in the header of outbound internal message (becoming <code>out_int_msg.header.fwd_fee</code>) and will go to validators who will process the message.</p><p>If, while being forwarded to the destination address, the message passes through additional validator sets (i.e. if the validator set changes more than once while the message is being forwarded), a part of <code>out_int_msg.header.fwd_fee</code> is payed to the relevant validator set every time and the remaining fee in the message header is reduced by this amount:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">intermediate_fee = out_int_msg.header.fwd_fee * next_frac / 2 ^ 16</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>next_frac</code> — is contained in global config parameters <code>p24</code> and <code>p25</code>, and determines the fraction of the remaining forward fee, that intermediary validators receive.</p><blockquote><p><strong>Note:</strong> Current global configuration can be always reviewed on <a href="https://ever.live/" target="_blank" rel="noopener noreferrer">ever.live</a> in the master config section of the latest key block details (<a href="https://net.ever.live/blocks?section=details&amp;id=8cee868a94b1e22794a927279286dc95498310cda982f4657e351a3da693cf27" target="_blank" rel="noopener noreferrer">example</a>) <code>FIXME broken link</code>.</p></blockquote><blockquote><p><strong>Note:</strong> Length of route does not affect the initial calculation of the forward fee. The fee is simply split between all involved validators according to global config parameters.</p></blockquote><blockquote><p><strong>Note:</strong> If an exception is thrown, and a bounce message is generated, it is subject to fees, just like a single regular outbound message.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="inbound-external-messages">Inbound external messages<a href="#inbound-external-messages" class="hash-link" aria-label="Direct link to Inbound external messages" title="Direct link to Inbound external messages">​</a></h4><p>Whenever an inbound external message needs to be imported for transaction execution, the for this action fee is calculated according to the <a href="#message-fees">standard forwarding fee formula</a>, and paid to the current validators.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="action-fees">Action fees<a href="#action-fees" class="hash-link" aria-label="Direct link to Action fees" title="Direct link to Action fees">​</a></h3><p>Action fees pay for performing &#x27;send message&#x27; actions. They consist of all fees for external outbound messages, and the first fraction of internal outbound message fees. They are calculated as follows:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">total_action_fees = total_out_ext_msg_fwd_fee + total_int_msg_mine_fee</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>where:</p><p><code>total_out_ext_msg_fwd_fee</code> — sum of implicit forward fee for all generated outbound external messages.
<code>total_int_msg_mine_fee</code> — sum of &#x27;mine&#x27; parts of message forward fees for outbound internal messages.
<code>total_fwd_fees</code> — is a separate way to calculate total forwarding fees.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">total_fwd_fees = total_action_fees + SUM(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int_msg_remain_fee</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    + out_int_msg.header.ihr_fee</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>out_int_msg.header.ihr_fee</code> — this fee is currently zero.</p><p>The action fee might be absent if no actions are performed during the transaction.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="gas-fees">Gas fees<a href="#gas-fees" class="hash-link" aria-label="Direct link to Gas fees" title="Direct link to Gas fees">​</a></h3><p><code>trans.gas_fees</code> includes all gas fees associated with the transaction.</p><p>As with Action fees, Gas fees are not always applicable. They can be skipped if the TVM compute phase is not initialized for a transaction.</p><p>In order to study the calculation of Gas fees in detail please consult <a href="/arch/managing-gas">this page</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="managing-gas">Managing gas<a href="#managing-gas" class="hash-link" aria-label="Direct link to Managing gas" title="Direct link to Managing gas">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="gas-calculation-basics">Gas calculation basics<a href="#gas-calculation-basics" class="hash-link" aria-label="Direct link to Gas calculation basics" title="Direct link to Gas calculation basics">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="specification-overview">Specification Overview<a href="#specification-overview" class="hash-link" aria-label="Direct link to Specification Overview" title="Direct link to Specification Overview">​</a></h4><p>The entire state of TVM consists of the five components:</p><ul><li>Stack</li><li>Control registers</li><li>Current continuation</li><li>Current codepage</li><li>Gas limits</li></ul><p>Collectively these are called <code>SCCCG</code>.</p><p>Check out section <strong>1.4</strong> of the <a href="https://ton.org/tvm.pdf" target="_blank" rel="noopener noreferrer">TVM specification</a>.</p><p>The <strong>Gas</strong> component limits gas usage and сontains four signed 64-bit integers:</p><ul><li>the remaining gas: <strong>gr</strong></li><li>the current gas limit: <strong>gl</strong></li><li>the maximal gas limit: <strong>gm</strong></li><li>the gas credit: <strong>gc</strong></li></ul><p>The following is always true:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>g</mi><mi>l</mi><mo>≤</mo><mi>g</mi><mi>m</mi><mo separator="true">,</mo><mi>g</mi><mi>c</mi><mo>≥</mo><mn>0</mn><mo separator="true">,</mo><mi>a</mi><mi>n</mi><mi>d</mi><mi>g</mi><mi>r</mi><mo>≤</mo><mi>g</mi><mi>l</mi><mo>+</mo><mi>g</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">0 ≤ gl ≤ gm, gc ≥ 0, and gr ≤ gl + gc</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8304em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">an</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal">c</span></span></span></span></span></div><p><strong>gc</strong> is initialized by zero for internal messages, <strong>gr</strong> is initialized by <code>gl + gc</code> and gradually decreases, as the TVM runs. When gr becomes negative or if contract terminates with <code>gc &gt; 0</code>, an <strong>out of gas</strong> exception is triggered.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="gas-prices">Gas prices<a href="#gas-prices" class="hash-link" aria-label="Direct link to Gas prices" title="Direct link to Gas prices">​</a></h4><p>As stated in <strong>A.1</strong> of the <a href="https://ton.org/tvm.pdf" target="_blank" rel="noopener noreferrer">TVM specification</a>.</p><p>According to the original TON, for most primitives gas is calculated according to the following formula:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mi>b</mi><mo>:</mo><mo>=</mo><mn>10</mn><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Pb := 10 + b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">10</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">b</span></span></span></span></span></div><p>where <strong>b</strong> is the instruction length in bits. The same is true for EverX implementation.</p><p><strong>For example:</strong> the gas required for <code>A0</code> (<strong>ADD</strong>) instruction is <code>10 + 8 = 18 gas</code>, while the gas for <code>A6cc</code> (<strong>ADDCONST</strong> <code>cc</code>) instruction is <code>10 + 16 = 26 gas</code>.</p><p>For some instructions this rule does not apply. TVM specification lists either total gas prices, or prices in addition to the basic <strong>Pb</strong> for them explicitly.</p><p>Instruction list with additional information may be obtained in <strong>A.2</strong> through <strong>A.13</strong> of the <a href="https://ton.org/tvm.pdf" target="_blank" rel="noopener noreferrer">TVM specification</a>.</p><p>Apart from integer constants, the following expressions may appear:</p><ul><li>The total price of loading cells. Currently it is 100 gas units per cell. Reloading a cell again now costs 25 gas units.</li><li>The total price of creating new Cells from Builders. Currently it is 500 gas units.</li><li>Exception throwing. 50 gas units per exception.</li><li>Exiting the block costs 5 gas units per implicit RET. Jumping to the first link costs 10 gas units - implicit JUMP.</li><li>Moving to a new continuation with transferring parameters costs gas if there are more then 32 parameters. It costs N-32 gas, where N is the number of parameters.</li><li>Tuple gas price. 1 gas unit for every tuple element.</li></ul><blockquote><p><strong>Note:</strong> that the most expensive operations are dictionary read/write operations. Dictionaries are stored in the form of trees of cells, where each cell can only be linked to four others. As result, these trees can grow quite large, depending on the data that needs to be stored. To read data in any cell, all its parent cells need to be read first, at the price of 100 gas per cell, and to write data in a cell, similarly all its parent cells need to be (re)created at the price of 500 gas per cell.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="global-gas-limits">Global gas limits<a href="#global-gas-limits" class="hash-link" aria-label="Direct link to Global gas limits" title="Direct link to Global gas limits">​</a></h4><p>Global gas limits are values stored in the masterchain configuration contract. Global values are standard and do not change at contract deployment. Only validator consensus can modify them.</p><p>The values currently used can always be reviewed on <a href="https://ever.live/" target="_blank" rel="noopener noreferrer">ever.live</a> in the latest key block details (<a href="https://net.ever.live/blocks?section=details&amp;id=8cee868a94b1e22794a927279286dc95498310cda982f4657e351a3da693cf27" target="_blank" rel="noopener noreferrer">example</a> <code>FIXME broken link</code>). <code>p20</code> config parameter values are used for masterchain and <code>p21</code> values are used for workchain.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="gas-related-tvm-primitives">Gas-related TVM primitives<a href="#gas-related-tvm-primitives" class="hash-link" aria-label="Direct link to Gas-related TVM primitives" title="Direct link to Gas-related TVM primitives">​</a></h4><p>These is the list of official TVM primitives used for gas-related operations:</p><ul><li><code>F800</code> — <code>ACCEPT</code>, sets current gas limit <strong>gl</strong> to its maximal allowed value <strong>gm</strong>, and resets the gas credit <strong>gc</strong> to zero, decreasing the value of <strong>gr</strong> by <strong>gc</strong> in the process. In other words, the current smart contract agrees to buy some gas to finish the current transaction. This action is required to process external messages, which bring no value (hence no gas) with themselves.</li><li><code>F801</code> — <code>SETGASLIMIT (g – )</code>, sets current gas limit gl to the minimum of g and gm, and resets the gas credit <strong>gc</strong> to zero. If the gas consumed so far (including the present instruction) exceeds the resulting value of <strong>gl</strong>, an (unhandled) out of gas exception is thrown before setting new gas limits. Notice that <code>SETGASLIMIT</code> with an argument <code>g ≥ 2 63 − 1</code> is equivalent to <code>ACCEPT</code>.</li><li><code>F802</code> — <code>BUYGAS (x – )</code>, computes the amount of gas that can be bought for <strong>x</strong> nanotokens, and sets <strong>gl</strong> accordingly in the same way as SETGASLIMIT.</li><li><code>F804</code> — <code>GRAMTOGAS (x – g)</code>, computes the amount of gas that can be bought for <strong>x</strong> nanotokens. If <strong>x</strong> is negative, returns 0. If <strong>g</strong> exceeds 2 63−1, it is replaced with this value.</li><li><code>F805</code> — <code>GASTOGRAM (g – x)</code>, computes the price of <strong>g</strong> gas in nanotokens.</li><li><code>F806–F80F</code> — Reserved for gas-related primitives. These are yet to be released.</li></ul><blockquote><p><strong>Note:</strong> F802, F804, F805 are not implemented in Telegram TON node.</p></blockquote><p>In Evernode, the general gas formula is the same as specified by TON specifications. Overall, Evernode operate in compliance with the specification.</p><p>For every executed primitive, the amount of gas is added to the virtual machine according to the specification formula. Gas value for every primitive is based on gr.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="gas-initialization-types">Gas initialization types<a href="#gas-initialization-types" class="hash-link" aria-label="Direct link to Gas initialization types" title="Direct link to Gas initialization types">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-calling-contract-from-another-contract">1. Calling contract from another contract<a href="#1-calling-contract-from-another-contract" class="hash-link" aria-label="Direct link to 1. Calling contract from another contract" title="Direct link to 1. Calling contract from another contract">​</a></h4><p>An internal message with a balance value is received. In this case, the following formulas are applied to determine limits:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gm = MIN(account balance / gas price, global_gas_limit)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gl = MIN(message value / gas price, global_gas_limit)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gc = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gr = gc + gl</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>By default, gas costs are allocated to the caller contract that triggers the transaction with a message. Accepting is also available for internal contracts. If <code>ACCEPT</code> is not called, gas is taken from the caller contract according to the message value. In other words, the message value defines the current limit. The message value determines the starting TVM gas limit.</p><p>So, to put it plain, if <code>ACCEPT</code> is not called, the message pays, if <code>ACCEPT</code> is used, additional gas can be bought by the target contract. This approach enables flexible contract design where either total gas is paid by the caller contract (but in this case it has to have enough gas at any moment of time) or the target contract also incurs costs.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-offchain-contract-call">2. Offchain contract call<a href="#2-offchain-contract-call" class="hash-link" aria-label="Direct link to 2. Offchain contract call" title="Direct link to 2. Offchain contract call">​</a></h4><p>External messages do not carry balance values. In this case, the values are calculated according to the following formulas:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gm = MIN(account balance / gas price, global_gas_limit)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gl = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gc = MIN(gm, global_gas_credit)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gr = gc + gl</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As external messages have no gas value, gas is credited to execute it. Target contracts have to cover costs by calling Accept to buy gas.</p><p>If a contract returns an exception before the credit is given, no gas fee applies.</p><p>As the public code for node has just been released this documentation is likely to be updated.</p><p>Managing Gas in Solidity
Some Theory
Anyone can send external message to your contract. When a message arrives, the contract initial gas limit is equal to 10,000 units of credit gas that should be bought later by the ACCEPT TVM primitive. Otherwise when credit gas falls to zero, the TVM throws the out of gas exception. The contract is supposed to spend these 10,000 units of &#x27;free&#x27; gas to check the body of an inbound message tp make sure that it is valid and can be processed by contract successfully.</p><p>The idea of credit gas allowance is that as long as it is beyond zero, any exception thrown by contract prevents all further gas charges. But once the contract accepts a message, all gas consumed by contract is converted to gas fees regardless of whether a transaction is aborted or not.</p><p>ACCEPT is useful in internal messages too. When another contract sends an internal message to your contract, initial gas limit is equal to an inbound message value divided by the gas_price or global gas limit, if it is smaller. If this value is not enough to finish execution, the contract then can increase its gas limit by calling ACCEPT or SETGASLIMIT primitive. The ACCEPT primitive increases the limit to the value of its balance divided by the gas_price, and the SETGASLIMIT primitive sets the current gas limit to the value popped from the TVM stack (the value cannot be bigger than the gm limit).</p><p>With the ACCEPT command a contract can choose whether gas for its execution is paid by the caller contract or by the contract itself.</p><p>Implementation
In EverX the ACCEPT primitive is implemented in Solidity as a private function called by public functions.</p><p>Find below actual usage examples. All can be compiled using EverX Solidity compiler.</p><p>Accept gas inside function
To avoid gas payment when the foo function is called by another contract, we can use the following code:</p><p>Remember that the caller contract should attach enough tokens to its message to cover all gas that will be spend by foo function.</p><p>Accept gas inside modifier</p><div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">contract</span><span class="token plain"> </span><span class="token class-name">AcceptExample2</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">uint</span><span class="token plain"> _sum </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">modifier</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AlwaysAccept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tvm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">accept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">_</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">uint</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">uint</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AlwaysAccept</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        _sum </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong>Important:</strong> modifier is called before arguments are deserialized from inbound message body. In the example above <code>AlwaysAccept()</code> will be called before <code>a</code> and <code>b</code> are decoded.</p></blockquote></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/everscale-org/docs/edit/main/.build/website/../../src/arch/25-fee-calculation.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-07-30T11:53:47.000Z">Jul 30, 2023</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/arch/tvm"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">TVM</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/arch/managing-gas"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Gas Calculation</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#fee-calculation" class="table-of-contents__link toc-highlight">Fee calculation</a><ul><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#storage-fees" class="table-of-contents__link toc-highlight">Storage fees</a></li><li><a href="#message-fees" class="table-of-contents__link toc-highlight">Message fees</a></li><li><a href="#action-fees" class="table-of-contents__link toc-highlight">Action fees</a></li><li><a href="#gas-fees" class="table-of-contents__link toc-highlight">Gas fees</a></li></ul></li><li><a href="#managing-gas" class="table-of-contents__link toc-highlight">Managing gas</a><ul><li><a href="#gas-calculation-basics" class="table-of-contents__link toc-highlight">Gas calculation basics</a></li><li><a href="#gas-initialization-types" class="table-of-contents__link toc-highlight">Gas initialization types</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">About</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/everscale-org/job/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Jobs and Vacancy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://everscale.network/files/Everscale_Whitepaper.pdf" target="_blank" rel="noopener noreferrer" class="footer__link-item">White Paper<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://everscale.network/files/Everscale_Litepaper.pdf" target="_blank" rel="noopener noreferrer" class="footer__link-item">Lite Paper<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/@everscale.network/search?query=Digest" target="_blank" rel="noopener noreferrer" class="footer__link-item">Digest<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://everscale.network/about/brand" target="_blank" rel="noopener noreferrer" class="footer__link-item">Visual Brand Identity<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://everscale.network/grants" target="_blank" rel="noopener noreferrer" class="footer__link-item">Grants<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/everscale-org/bounties/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Bounties<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://t.me/EverscaleSmartContracts" target="_blank" rel="noopener noreferrer" class="footer__link-item">Smart Contracts Chat<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://t.me/ever_validators" target="_blank" rel="noopener noreferrer" class="footer__link-item">Everscale Validators Channel<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://t.me/everscaledebots" target="_blank" rel="noopener noreferrer" class="footer__link-item">DeBots Chat<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://t.me/ever_sdk" target="_blank" rel="noopener noreferrer" class="footer__link-item">SDK Chat<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/everscale" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Workshop</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://everscale.guide/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Crash Course<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/develop/smart-contracts/">EverDev Tutorial</a></li><li class="footer__item"><a href="https://youtu.be/XKMnroPWXek" target="_blank" rel="noopener noreferrer" class="footer__link-item">Smart contract architecture<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://youtu.be/YBIaFeaksMY" target="_blank" rel="noopener noreferrer" class="footer__link-item">Smart contract development<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://youtu.be/vFAatJO6cBM" target="_blank" rel="noopener noreferrer" class="footer__link-item">Development of DeBots<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/tonlabs/samples" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sample smart-contracts<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/tonlabs/sdk-samples" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sample SDK<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/tonlabs/TON-Solidity-Compiler/blob/master/API.md" target="_blank" rel="noopener noreferrer" class="footer__link-item">Solidity API<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/spec/abi/">ABI Specification</a></li><li class="footer__item"><a class="footer__link-item" href="/standard/TIP-4/">NFT</a></li><li class="footer__item"><a href="https://github.com/tonlabs/tonos-cli" target="_blank" rel="noopener noreferrer" class="footer__link-item">CLI<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docs.everos.dev/ever-sdk/" target="_blank" rel="noopener noreferrer" class="footer__link-item">SDK<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2020—2023
 <a href="https://everscale.network/">Everscale</a> All rights reserved
  <a href="https://t.me/everscale">Touch</a>
 <br>
 <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
    <img alt="Creative Commons License" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png">
 </a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.2cff1c02.js"></script>
<script src="/assets/js/main.d6bf648e.js"></script>
</body>
</html>